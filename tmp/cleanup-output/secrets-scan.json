[
  {
    "file": ".env.example",
    "line": 3,
    "snippet": "SERVICE_ROLE_KEY= STRIPE_SECRET_KEY= STRIPE_WEBHOOK_SECRET= # ä¸­æ–‡æ³¨é‡Šï¼šStripe Checkout å›è·³çš„å‰ç«¯åŸºå€ï¼ˆå¦‚ http://localhost:5173ï¼‰ FRON"
  },
  {
    "file": ".github/settings.yml",
    "line": 9,
    "snippet": "private: false      # å¯ç”¨åŠŸèƒ½   has_issues: true   has_projects: false   has_wiki: false      # åˆå¹¶è®¾ç½®   allow_squash"
  },
  {
    "file": "CHANGELOG.md",
    "line": 5,
    "snippet": "password.html` ä»é¡¹ç›®æ ¹ç›®å½•ç§»åŠ¨åˆ° `public/`ï¼Œä¸é™æ€èµ„æºçº¦å®šä¿æŒä¸€è‡´ã€‚  ### Docsï¼ˆæ–‡æ¡£ï¼‰ - æ›´æ–° `README.md`ï¼šå°†æ–‡æ¡£ä¸­çš„ `js/` è·¯å¾„ç»Ÿä¸€ä¸º `src/js/`ï¼Œå¹¶è¡¥å…… `reset"
  },
  {
    "file": "CHANGELOG.md",
    "line": 8,
    "snippet": "password.html` é¡µé¢èŒè´£è¯´æ˜ã€‚  ## v0.3.15 - 2025-12-06 ### Addedï¼ˆæ–°å¢ï¼‰ - è´¦å·æ¢å¤å…¨é“¾è·¯ï¼š`request-recovery` / `confirm-recovery` / `s"
  },
  {
    "file": "CHANGELOG.md",
    "line": 12,
    "snippet": "password` ä¸‰ä¸ª Edge Functionsï¼Œå®ç°ä¸€æ¬¡æ€§ä»¤ç‰Œä¸å¼ºå¯†ç è®¾ç½®ã€‚ - å‰ç«¯é¡µé¢ï¼š`account-recovery.html` ä¸ `set-password.html`ï¼Œå¼€å‘æ¨¡å¼è¿”å› `preview_link` ä¾¿"
  },
  {
    "file": "CHANGELOG.md",
    "line": 13,
    "snippet": "password.html`ï¼Œå¼€å‘æ¨¡å¼è¿”å› `preview_link` ä¾¿äºç«¯åˆ°ç«¯è”è°ƒã€‚ - ç™»å½•é¡µ OAuth-first è¡Œä¸ºï¼šä»…åœ¨ç¤¾åª’ç™»å½•å¤±è´¥æ—¶æ˜¾ç¤ºç°è‰²å°å…¥å£â€œéœ€è¦å¸®åŠ©ç™»å½•ï¼Ÿè´¦å·æ¢å¤â€ã€‚  ### Changedï¼ˆä¿®æ”¹ï¼‰ -"
  },
  {
    "file": "CHANGELOG.md",
    "line": 13,
    "snippet": "preview_link` ä¾¿äºç«¯åˆ°ç«¯è”è°ƒã€‚ - ç™»å½•é¡µ OAuth-first è¡Œä¸ºï¼šä»…åœ¨ç¤¾åª’ç™»å½•å¤±è´¥æ—¶æ˜¾ç¤ºç°è‰²å°å…¥å£â€œéœ€è¦å¸®åŠ©ç™»å½•ï¼Ÿè´¦å·æ¢å¤â€ã€‚  ### Changedï¼ˆä¿®æ”¹ï¼‰ - `login.html` é‡‡ç”¨æç®€ç™½å¡ç‰‡ä¸ä¸»"
  },
  {
    "file": "CHANGELOG.md",
    "line": 393,
    "snippet": "SERVICE_ROLE_KEY` / `OPENAI_API_KEY`ï¼‰ã€‚  ### Changed - `main.js` çš„æ–°å¢/ç¼–è¾‘/åˆ é™¤é€»è¾‘åœ¨æœ¬åœ°æ¨¡å¼ä¸‹è·³è¿‡æ‰€æœ‰ç½‘ç»œè°ƒç”¨ï¼Œä»…æœ¬åœ°æŒä¹…åŒ–ã€‚ - Function æµ‹è¯•æŒ‰é’®åœ¨æœ¬åœ°"
  },
  {
    "file": "README.md",
    "line": 47,
    "snippet": "password.html?token=...`ã€‚ - è®¾ç½®å¯†ç ï¼šåœ¨ `set-password.html` è¾“å…¥å¹¶ç¡®è®¤æ–°å¯†ç ï¼ˆâ‰¥8 ä½ï¼Œå«å­—æ¯ä¸æ•°å­—ï¼‰ï¼ŒæˆåŠŸåå¯ä½¿ç”¨é‚®ç®±+å¯†ç ç™»å½•ï¼Œä¸”ä¿ç•™ç¤¾åª’ç™»å½•ç»‘å®šã€‚ - å®‰å…¨æ–‡æ¡ˆï¼šé¡µé¢å§‹ç»ˆä½¿ç”¨æ¨¡ç³Šæç¤ºï¼Œ"
  },
  {
    "file": "README.md",
    "line": 47,
    "snippet": "token=...`ã€‚ - è®¾ç½®å¯†ç ï¼šåœ¨ `set-password.html` è¾“å…¥å¹¶ç¡®è®¤æ–°å¯†ç ï¼ˆâ‰¥8 ä½ï¼Œå«å­—æ¯ä¸æ•°å­—ï¼‰ï¼ŒæˆåŠŸåå¯ä½¿ç”¨é‚®ç®±+å¯†ç ç™»å½•ï¼Œä¸”ä¿ç•™ç¤¾åª’ç™»å½•ç»‘å®šã€‚ - å®‰å…¨æ–‡æ¡ˆï¼šé¡µé¢å§‹ç»ˆä½¿ç”¨æ¨¡ç³Šæç¤ºï¼Œä¸æ³„éœ²é‚®ç®±æ˜¯å¦å­˜åœ¨ï¼›ä»¤ç‰Œå‡ä¸€"
  },
  {
    "file": "README.md",
    "line": 48,
    "snippet": "password.html` è¾“å…¥å¹¶ç¡®è®¤æ–°å¯†ç ï¼ˆâ‰¥8 ä½ï¼Œå«å­—æ¯ä¸æ•°å­—ï¼‰ï¼ŒæˆåŠŸåå¯ä½¿ç”¨é‚®ç®±+å¯†ç ç™»å½•ï¼Œä¸”ä¿ç•™ç¤¾åª’ç™»å½•ç»‘å®šã€‚ - å®‰å…¨æ–‡æ¡ˆï¼šé¡µé¢å§‹ç»ˆä½¿ç”¨æ¨¡ç³Šæç¤ºï¼Œä¸æ³„éœ²é‚®ç®±æ˜¯å¦å­˜åœ¨ï¼›ä»¤ç‰Œå‡ä¸€æ¬¡æ€§ä½¿ç”¨å¹¶è¿‡æœŸå›æ”¶ã€‚  Edge Functions"
  },
  {
    "file": "README.md",
    "line": 52,
    "snippet": "preview_link`ï¼‰ã€‚ - `supabase/functions/confirm-recovery`ï¼šæ ¡éªŒå¹¶æ ‡è®° `recovery_token` å·²ç”¨ï¼Œç”Ÿæˆ `set_password_token`ï¼Œé‡å®šå‘åˆ°å‰ç«¯è®¾ç½®å¯†ç é¡µã€‚ -"
  },
  {
    "file": "README.md",
    "line": 54,
    "snippet": "password`ï¼šæ ¡éªŒäºŒçº§ä»¤ç‰Œå¹¶ä¸ºæ—¢æœ‰ `user_id` åˆ›å»ºå¯†ç å‡­è¯ï¼Œå†™å…¥å®¡è®¡ã€‚  å‰ç«¯é¡µé¢ï¼š - `login.html`ï¼šOAuth-first å¸ƒå±€ï¼ŒGoogle ç™»å½•ä¸ºä¸»æŒ‰é’®ï¼›ä»…åœ¨ç¤¾åª’ç™»å½•å¤±è´¥æ—¶æ˜¾ç¤ºç°è‰²â€œè´¦å·æ¢å¤â€å…¥å£ã€‚ - "
  },
  {
    "file": "README.md",
    "line": 58,
    "snippet": "preview_link` ä¾¿äºè”è°ƒã€‚ - `set-password.html`ï¼šè®¾ç½®å¯†ç é¡µé¢ï¼Œæ ¡éªŒå¼ºå¯†ç è§„åˆ™ï¼Œæäº¤åæç¤ºæˆåŠŸå¹¶è·³è½¬ç™»å½•ã€‚ - `reset-password.html`ï¼šå¿˜è®°å¯†ç é‡ç½®é¡µï¼ˆSupabase é‚®ä»¶é“¾æ¥å›è·³ï¼‰ï¼Œ"
  },
  {
    "file": "README.md",
    "line": 59,
    "snippet": "password.html`ï¼šè®¾ç½®å¯†ç é¡µé¢ï¼Œæ ¡éªŒå¼ºå¯†ç è§„åˆ™ï¼Œæäº¤åæç¤ºæˆåŠŸå¹¶è·³è½¬ç™»å½•ã€‚ - `reset-password.html`ï¼šå¿˜è®°å¯†ç é‡ç½®é¡µï¼ˆSupabase é‚®ä»¶é“¾æ¥å›è·³ï¼‰ï¼ŒåŸºäºä¸´æ—¶ Session æ›´æ–°å¯†ç ã€‚  ç¯å¢ƒå˜é‡ï¼ˆç”Ÿäº§"
  },
  {
    "file": "README.md",
    "line": 60,
    "snippet": "password.html`ï¼šå¿˜è®°å¯†ç é‡ç½®é¡µï¼ˆSupabase é‚®ä»¶é“¾æ¥å›è·³ï¼‰ï¼ŒåŸºäºä¸´æ—¶ Session æ›´æ–°å¯†ç ã€‚  ç¯å¢ƒå˜é‡ï¼ˆç”Ÿäº§/CI å¿…é…ï¼‰ï¼š - `EMAIL_PROVIDER`ï¼ˆsendgrid | mailgunï¼‰ - `EM"
  },
  {
    "file": "README.md",
    "line": 67,
    "snippet": "SERVICE_ROLE_KEY`ï¼ˆä»…åç«¯ï¼Œä¸å¯æš´éœ²ç»™å‰ç«¯ï¼‰ - `FRONTEND_BASE_URL`ï¼ˆæ¢å¤é‡å®šå‘ä¸å›è·³ï¼‰  å¼€å‘æ¨¡å¼è¯´æ˜ï¼š - å¼€å‘ç¯å¢ƒæ— éœ€çœŸå®å‘ä¿¡ï¼Œ`request-recovery` è¿”å› `preview_link"
  },
  {
    "file": "README.md",
    "line": 71,
    "snippet": "preview_link` ç”¨äºç«¯åˆ°ç«¯è”è°ƒï¼›ç›¸å…³æµ‹è¯•è¦†ç›–ä»¤ç‰Œç”Ÿå‘½å‘¨æœŸä¸é€Ÿç‡é™åˆ¶ã€‚  ## æ‰‹åŠ¨æµ‹è¯•æ­¥éª¤ 1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼š`npm run dev`ï¼Œæ‰“å¼€ `http://localhost:5173`ã€‚ 2. æ‰“å¼€é¦–é¡µï¼ˆLanding"
  },
  {
    "file": "README.md",
    "line": 77,
    "snippet": "preview_link` â†’ æ‰“å¼€æ¢å¤é“¾æ¥åè·³è½¬ `set-password.html` â†’ è®¾ç½®æ–°å¯†ç ã€‚ 4. æ³¨å†Œï¼šç‚¹å‡»â€œæ³¨å†Œä¸€ä¸ªâ€ â†’ è¿›å…¥ `register.html` â†’ æ³¨å†ŒæˆåŠŸ â†’ æç¤ºéªŒè¯æˆ–è·³è½¬ã€‚ 5. è®¿é—®æ§åˆ¶ï¼šæ‰‹åŠ¨ç™»"
  },
  {
    "file": "README.md",
    "line": 77,
    "snippet": "password.html` â†’ è®¾ç½®æ–°å¯†ç ã€‚ 4. æ³¨å†Œï¼šç‚¹å‡»â€œæ³¨å†Œä¸€ä¸ªâ€ â†’ è¿›å…¥ `register.html` â†’ æ³¨å†ŒæˆåŠŸ â†’ æç¤ºéªŒè¯æˆ–è·³è½¬ã€‚ 5. è®¿é—®æ§åˆ¶ï¼šæ‰‹åŠ¨ç™»å‡º â†’ è®¿é—® `dashboard.html` â†’ åº”è‡ªåŠ¨è·³å›"
  },
  {
    "file": "README.md",
    "line": 96,
    "snippet": "SERVICE_ROLE_KEY`ã€`STRIPE_SECRET_KEY`ã€`STRIPE_WEBHOOK_SECRET` - è¯·åœ¨å¼€å‘/æµ‹è¯•/ç”Ÿäº§ç¯å¢ƒåˆ†åˆ«é…ç½® keyï¼Œé¿å…åœ¨ dev ä½¿ç”¨ç”Ÿäº§å¯†é’¥ "
  },
  {
    "file": "blueprint.md",
    "line": 75,
    "snippet": "Tokenã€Sync çŠ¶æ€ã€PWA 3.2 Controllers æ§åˆ¶å™¨\tæ–‡ä»¶\tåŠŸèƒ½ LinkController\tlinkController.js\tç™»å½•åå¯åŠ¨åŒæ­¥ã€ç»‘å®š UI DataController\tdataContro"
  },
  {
    "file": "languages/en.json",
    "line": 6,
    "snippet": "password\": \"Password\",   \"confirmPassword\": \"Confirm Password\",   \"forgotPassword\": \"Forgot Password?\",   \"rememberMe\": "
  },
  {
    "file": "languages/en.json",
    "line": 6,
    "snippet": "Password\",   \"confirmPassword\": \"Confirm Password\",   \"forgotPassword\": \"Forgot Password?\",   \"rememberMe\": \"Remember Me"
  },
  {
    "file": "languages/en.json",
    "line": 7,
    "snippet": "Password\",   \"forgotPassword\": \"Forgot Password?\",   \"rememberMe\": \"Remember Me\",   \"welcome\": \"Welcome back\",   \"welcom"
  },
  {
    "file": "languages/en.json",
    "line": 8,
    "snippet": "Password?\",   \"rememberMe\": \"Remember Me\",   \"welcome\": \"Welcome back\",   \"welcomeMorning\": \"Good morning, {name} ğŸŒ…\",  "
  },
  {
    "file": "languages/ms.json",
    "line": 6,
    "snippet": "password\": \"Kata Laluan\",   \"confirmPassword\": \"Sahkan Kata Laluan\",   \"forgotPassword\": \"Lupa Kata Laluan?\",   \"remembe"
  },
  {
    "file": "languages/zh.json",
    "line": 6,
    "snippet": "password\": \"å¯†ç \",   \"confirmPassword\": \"ç¡®è®¤å¯†ç \",   \"forgotPassword\": \"å¿˜è®°å¯†ç ï¼Ÿ\",   \"rememberMe\": \"è®°ä½æˆ‘\",   \"welcome\": \"æ¬¢è¿å›æ¥\",  "
  },
  {
    "file": "package-lock.json",
    "line": 2232,
    "snippet": "preview\": \"4.0.14\",         \"@vitest/browser-webdriverio\": \"4.0.14\",         \"@vitest/ui\": \"4.0.14\",         \"happy-d"
  },
  {
    "file": "package-lock.json",
    "line": 2251,
    "snippet": "preview\": {           \"optional\": true         },         \"@vitest/browser-webdriverio\": {           \"optional\": tru"
  },
  {
    "file": "package.json",
    "line": 4,
    "snippet": "private\": true,   \"scripts\": {     \"dev\": \"vite --host\",     \"build\": \"vite build\",     \"preview\": \"vite preview\", "
  },
  {
    "file": "package.json",
    "line": 8,
    "snippet": "preview\": \"vite preview\",     \"lint:paths\": \"node scripts/check_static_paths.js\"   },   \"devDependencies\": {     \"fa"
  },
  {
    "file": "package.json",
    "line": 8,
    "snippet": "preview\",     \"lint:paths\": \"node scripts/check_static_paths.js\"   },   \"devDependencies\": {     \"fake-indexeddb\": \""
  },
  {
    "file": "public/account-recovery.html",
    "line": 76,
    "snippet": "preview = payload?.data?.preview_link;           if (preview) {             const a = document.createElement('a'); a.hre"
  },
  {
    "file": "public/account-recovery.html",
    "line": 76,
    "snippet": "preview_link;           if (preview) {             const a = document.createElement('a'); a.href = preview; a.target = '"
  },
  {
    "file": "public/account-recovery.html",
    "line": 77,
    "snippet": "preview) {             const a = document.createElement('a'); a.href = preview; a.target = '_blank'; a.textContent = 'é¢„è§ˆ"
  },
  {
    "file": "public/account-recovery.html",
    "line": 78,
    "snippet": "preview; a.target = '_blank'; a.textContent = 'é¢„è§ˆæ¢å¤é“¾æ¥'; a.className = 'block mt-2 text-primary hover:text-primary-hover'"
  },
  {
    "file": "public/components/modal_login.html",
    "line": 38,
    "snippet": "password\">å¯†ç </label>         <input           type=\"password\"           id=\"loginPassword\"           name=\"password\"    "
  },
  {
    "file": "public/components/modal_login.html",
    "line": 40,
    "snippet": "password\"           id=\"loginPassword\"           name=\"password\"           required           minlength=\"6\"           cl"
  },
  {
    "file": "public/components/modal_login.html",
    "line": 42,
    "snippet": "password\"           required           minlength=\"6\"           class=\"w-full px-3 py-2 border border-gray-300 rounded-lg"
  },
  {
    "file": "public/languages/en.json",
    "line": 6,
    "snippet": "password\": \"Password\",   \"confirmPassword\": \"Confirm Password\",   \"forgotPassword\": \"Forgot Password?\",   \"rememberMe\": "
  },
  {
    "file": "public/languages/en.json",
    "line": 6,
    "snippet": "Password\",   \"confirmPassword\": \"Confirm Password\",   \"forgotPassword\": \"Forgot Password?\",   \"rememberMe\": \"Remember Me"
  },
  {
    "file": "public/languages/en.json",
    "line": 7,
    "snippet": "Password\",   \"forgotPassword\": \"Forgot Password?\",   \"rememberMe\": \"Remember Me\",   \"welcome\": \"Welcome back\",   \"welcom"
  },
  {
    "file": "public/languages/en.json",
    "line": 8,
    "snippet": "Password?\",   \"rememberMe\": \"Remember Me\",   \"welcome\": \"Welcome back\",   \"welcomeMorning\": \"Good morning, {name} ğŸŒ…\",  "
  },
  {
    "file": "public/languages/ms.json",
    "line": 6,
    "snippet": "password\": \"Kata Laluan\",   \"confirmPassword\": \"Sahkan Kata Laluan\",   \"forgotPassword\": \"Lupa Kata Laluan?\",   \"remembe"
  },
  {
    "file": "public/languages/zh.json",
    "line": 6,
    "snippet": "password\": \"å¯†ç \",   \"confirmPassword\": \"ç¡®è®¤å¯†ç \",   \"forgotPassword\": \"å¿˜è®°å¯†ç ï¼Ÿ\",   \"rememberMe\": \"è®°ä½æˆ‘\",   \"welcome\": \"æ¬¢è¿å›æ¥\",  "
  },
  {
    "file": "public/login.html",
    "line": 127,
    "snippet": "password\" type=\"password\" required minlength=\"6\" autocomplete=\"current-password\" class=\"form-input\" placeholder=\"â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
  },
  {
    "file": "public/login.html",
    "line": 127,
    "snippet": "password\" required minlength=\"6\" autocomplete=\"current-password\" class=\"form-input\" placeholder=\"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢\" />           "
  },
  {
    "file": "public/login.html",
    "line": 127,
    "snippet": "password\" class=\"form-input\" placeholder=\"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢\" />               </div>               <!-- è®°ä½æˆ‘ -->               <di"
  },
  {
    "file": "public/login.html",
    "line": 215,
    "snippet": "preview = payload?.data?.preview_link;           if (preview) {             const a = document.createElement('a'); a.hre"
  },
  {
    "file": "public/login.html",
    "line": 215,
    "snippet": "preview_link;           if (preview) {             const a = document.createElement('a'); a.href = preview; a.target = '"
  },
  {
    "file": "public/login.html",
    "line": 216,
    "snippet": "preview) {             const a = document.createElement('a'); a.href = preview; a.target = '_blank'; a.textContent = 'é¢„è§ˆ"
  },
  {
    "file": "public/login.html",
    "line": 217,
    "snippet": "preview; a.target = '_blank'; a.textContent = 'é¢„è§ˆæ¢å¤é“¾æ¥'; a.className = 'block mt-2 text-primary hover:text-primary-hover'"
  },
  {
    "file": "public/register.html",
    "line": 87,
    "snippet": "password\" type=\"password\" required minlength=\"6\" autocomplete=\"new-password\"                    class=\"form-input\"      "
  },
  {
    "file": "public/register.html",
    "line": 87,
    "snippet": "password\" required minlength=\"6\" autocomplete=\"new-password\"                    class=\"form-input\"                    pl"
  },
  {
    "file": "public/register.html",
    "line": 87,
    "snippet": "password\"                    class=\"form-input\"                    placeholder=\"è‡³å°‘ 6 ä½å­—ç¬¦\" />           </div>           "
  },
  {
    "file": "public/register.html",
    "line": 95,
    "snippet": "password\" required minlength=\"6\" autocomplete=\"new-password\"                    class=\"form-input\"                    pl"
  },
  {
    "file": "public/register.html",
    "line": 95,
    "snippet": "password\"                    class=\"form-input\"                    placeholder=\"è¯·å†æ¬¡è¾“å…¥å¯†ç \" />           </div>            "
  },
  {
    "file": "public/set-password.html",
    "line": 46,
    "snippet": "password\" required minlength=\"8\" autocomplete=\"new-password\" class=\"form-input\" placeholder=\"è‡³å°‘ 8 ä½ï¼ŒåŒ…å«å­—æ¯ä¸æ•°å­—\" />         "
  },
  {
    "file": "public/set-password.html",
    "line": 46,
    "snippet": "password\" class=\"form-input\" placeholder=\"è‡³å°‘ 8 ä½ï¼ŒåŒ…å«å­—æ¯ä¸æ•°å­—\" />           </div>           <div>             <label for=\"pw"
  },
  {
    "file": "public/set-password.html",
    "line": 50,
    "snippet": "password\" required minlength=\"8\" autocomplete=\"new-password\" class=\"form-input\" placeholder=\"å†æ¬¡è¾“å…¥å¯†ç \" />           </div>"
  },
  {
    "file": "public/set-password.html",
    "line": 50,
    "snippet": "password\" class=\"form-input\" placeholder=\"å†æ¬¡è¾“å…¥å¯†ç \" />           </div>           <button id=\"btn-setpwd\" type=\"button\" cl"
  },
  {
    "file": "public/set-password.html",
    "line": 60,
    "snippet": "token å¹¶æäº¤åˆ° Edge Function è®¾ç½®å¯†ç        // ä¸­æ–‡æ³¨é‡Šï¼šæ”¹ä¸ºç›¸å¯¹è·¯å¾„ ../src/js/services/config.jsï¼Œé¿å…ç»å¯¹è·¯å¾„åœ¨æ„å»ºé˜¶æ®µæ— æ³•è§£æ       import config from"
  },
  {
    "file": "public/set-password.html",
    "line": 68,
    "snippet": "token = url.searchParams.get('token') || '';       if (!token) { result.className = 'mt-4 text-sm text-red-600'; result."
  },
  {
    "file": "public/set-password.html",
    "line": 68,
    "snippet": "token') || '';       if (!token) { result.className = 'mt-4 text-sm text-red-600'; result.textContent = 'é“¾æ¥æ— æ•ˆæˆ–ç¼ºå°‘ä»¤ç‰Œå‚æ•°'; r"
  },
  {
    "file": "public/set-password.html",
    "line": 69,
    "snippet": "token) { result.className = 'mt-4 text-sm text-red-600'; result.textContent = 'é“¾æ¥æ— æ•ˆæˆ–ç¼ºå°‘ä»¤ç‰Œå‚æ•°'; result.classList.remove('hi"
  },
  {
    "file": "public/set-password.html",
    "line": 78,
    "snippet": "password`;           const resp = await fetch(endpoint, { method: 'POST', headers: { 'Content-Type': 'application/json',"
  },
  {
    "file": "public/set-password.html",
    "line": 79,
    "snippet": "token, new_password: p1, client_req_id: crypto.randomUUID() }) });           const payload = await resp.json().catch(() "
  },
  {
    "file": "public/signup.html",
    "line": 75,
    "snippet": "password\" required minlength=\"6\" placeholder=\"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢\"                    class=\"w-full px-3 py-2 border border-gray-3"
  },
  {
    "file": "public/signup.html",
    "line": 81,
    "snippet": "password\" required minlength=\"6\" placeholder=\"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢\"                    class=\"w-full px-3 py-2 border border-gray-3"
  },
  {
    "file": "scripts/local_deploy_test.ps1",
    "line": 56,
    "snippet": "service_role key: (.*)\") { $ServiceKey = $matches[1].Trim() }  if (-not $AnonKey -or -not $ServiceKey) {     try {  "
  },
  {
    "file": "scripts/local_deploy_test.ps1",
    "line": 63,
    "snippet": "service_role_key         $ApiUrl = $JsonStatus.api_url     } catch {         Write-Error \"âŒ Failed to extract keys.\"\r"
  },
  {
    "file": "scripts/local_deploy_test.ps1",
    "line": 116,
    "snippet": "SERVICE_ROLE_KEY=$ServiceKey \"@ Set-Content \".env.local\" $EnvContent Write-Host \"âœ… .env.local created.\" -ForegroundCo"
  },
  {
    "file": "scripts/local_deploy_test.ps1",
    "line": 132,
    "snippet": "SERVICE_ROLE_KEY = $ServiceKey  try {     if (-not (Test-Path \"node_modules/@supabase/supabase-js\")) {         npm i"
  },
  {
    "file": "scripts/local_deploy_test_part2.ps1",
    "line": 40,
    "snippet": "service_role key: (.*)\") { $ServiceKey = $matches[1].Trim() }  if (-not $AnonKey -or -not $ServiceKey) {     # Fallba"
  },
  {
    "file": "scripts/local_deploy_test_part2.ps1",
    "line": 48,
    "snippet": "service_role_key         $ApiUrl = $JsonStatus.api_url     } catch {         Write-Error \"âŒ Failed to extract keys fr"
  },
  {
    "file": "scripts/local_deploy_test_part2.ps1",
    "line": 100,
    "snippet": "SERVICE_ROLE_KEY=$ServiceKey \"@ Set-Content \".env.local\" $EnvContent Write-Host \"âœ… .env.local created.\" -ForegroundCo"
  },
  {
    "file": "scripts/local_deploy_test_part2.ps1",
    "line": 119,
    "snippet": "SERVICE_ROLE_KEY = $ServiceKey  try {     # Install node dependencies for script (dotenv, @supabase/supabase-js)    "
  },
  {
    "file": "scripts/pre_merge_check.sh",
    "line": 9,
    "snippet": "Secret Scan echo \"ğŸ›¡ï¸ Scanning for secrets...\" # grep -r \"service_role\" . --exclude-dir=node_modules --exclude-dir=.gi"
  },
  {
    "file": "scripts/pre_merge_check.sh",
    "line": 11,
    "snippet": "service_role\" . --exclude-dir=node_modules --exclude-dir=.git # (Should return empty or only in .env.example / comments"
  },
  {
    "file": "scripts/verify_phase4.js",
    "line": 11,
    "snippet": "SERVICE_ROLE_KEY; const ANON_KEY = process.env.VITE_SUPABASE_ANON_KEY;  // ä¸­æ–‡æ³¨é‡Šï¼šåœ¨æœ¬åœ°å¼€å‘åœºæ™¯å…è®¸ç¼ºå¤± service_role_keyï¼Œä»…è¿›è¡Œç”¨æˆ·æ€ä¸å‡½æ•°éªŒè¯"
  },
  {
    "file": "scripts/verify_phase4.js",
    "line": 14,
    "snippet": "service_role_keyï¼Œä»…è¿›è¡Œç”¨æˆ·æ€ä¸å‡½æ•°éªŒè¯ if (!SUPABASE_URL || !ANON_KEY) {   console.error('Error: Missing environment variables. Pl"
  },
  {
    "file": "scripts/verify_phase4.js",
    "line": 25,
    "snippet": "SERVICE_ROLE_KEY missing. Admin cleanup will be skipped.'); }  // ä¸­æ–‡æ³¨é‡Šï¼šAdmin Clientï¼ˆå¯é€‰ï¼‰ç”¨äºæ•°æ®æ¸…ç†ä¸éªŒè¯ï¼›è‹¥ç¼ºå¤±åˆ™è·³è¿‡ const adminClie"
  },
  {
    "file": "scripts/verify_phase4.js",
    "line": 41,
    "snippet": "password = 'Password123!';   console.log(`\\nğŸ‘¤ Creating test user: ${email}`);      const { data: authData, error: au"
  },
  {
    "file": "scripts/verify_phase4.js",
    "line": 46,
    "snippet": "password,   });    if (authError) {     console.error('SignUp failed:', authError.message);     process.exit(1);  "
  },
  {
    "file": "scripts/verify_phase4.js",
    "line": 191,
    "snippet": "service_role_key). Please clean test user manually if needed.');   }    console.log('\\nğŸ‰ Phase 4 Verification Complete"
  },
  {
    "file": "scripts/verify_phase5.js",
    "line": 16,
    "snippet": "Token  if (!SUPABASE_URL || !SUPABASE_KEY) {   console.error('âŒ Missing VITE_SUPABASE_URL or VITE_SUPABASE_ANON_KEY')"
  },
  {
    "file": "scripts/verify_phase5.js",
    "line": 30,
    "snippet": "password)   // è‹¥ä¸å­˜åœ¨éœ€å…ˆåˆ›å»ºã€‚è¿™é‡Œå‡è®¾å·²å­˜åœ¨æˆ–ä½¿ç”¨åŒ¿åæµ‹è¯•ã€‚   // ç®€åŒ–ï¼šä½¿ç”¨ Service Key ç»•è¿‡ Auth ç›´æ¥è°ƒç”¨ RPCï¼ˆä»…ç”¨äºé›†æˆæµ‹è¯•é€»è¾‘éªŒè¯ï¼‰   // çœŸå®åœºæ™¯åº”ä½¿ç”¨ supabase.au"
  },
  {
    "file": "scripts/verify_phase5.js",
    "line": 39,
    "snippet": "password: 'password123' // å‡è®¾çš„æœ¬åœ°æµ‹è¯•å¯†ç    });      if (error) {     console.warn('âš ï¸ Login failed (expected if not seed"
  },
  {
    "file": "scripts/verify_phase5.js",
    "line": 44,
    "snippet": "Tokenã€‚     // å»ºè®®ï¼šåœ¨æµ‹è¯•å‰å…ˆ Seed ä¸€ä¸ªç”¨æˆ·ã€‚   }   return session?.access_token; }  async function runTest() {   console.log"
  },
  {
    "file": "scripts/verify_phase5.js",
    "line": 54,
    "snippet": "token = await login();   // å¦‚æœæ²¡æœ‰ tokenï¼Œåç»­è°ƒç”¨å¯èƒ½ä¼šå¤±è´¥ï¼ˆå–å†³äº RLSï¼‰      const user_id = (await supabase.auth.getUser()).data.u"
  },
  {
    "file": "scripts/verify_phase5.js",
    "line": 55,
    "snippet": "tokenï¼Œåç»­è°ƒç”¨å¯èƒ½ä¼šå¤±è´¥ï¼ˆå–å†³äº RLSï¼‰      const user_id = (await supabase.auth.getUser()).data.user?.id;   if (!user_id) {     c"
  },
  {
    "file": "src/js/features/auth_ui.js",
    "line": 25,
    "snippet": "password å‚æ•°ï¼Œè¯´æ˜å‘ç”Ÿäº†æ„å¤–çš„è¡¨å•æäº¤ï¼Œä¼˜å…ˆæ¸…ç†     if (window.location.search.includes('password=')) {       const url = new URL(window"
  },
  {
    "file": "src/js/features/auth_ui.js",
    "line": 26,
    "snippet": "password=')) {       const url = new URL(window.location);       url.searchParams.delete('password');       url.searc"
  },
  {
    "file": "src/js/features/auth_ui.js",
    "line": 28,
    "snippet": "password');       url.searchParams.delete('email');       url.searchParams.delete('remember');       window.history.r"
  },
  {
    "file": "src/js/features/auth_ui.js",
    "line": 120,
    "snippet": "Token   Object.keys(localStorage).forEach(key => {     if (key.startsWith('sb-') && key.endsWith('-auth-token')) {   "
  },
  {
    "file": "src/js/features/auth_ui.js",
    "line": 122,
    "snippet": "token')) {       localStorage.removeItem(key);     }   });    // ä¸­æ–‡æ³¨é‡Šï¼ˆP0 ä¿®å¤ï¼‰ï¼šç»Ÿä¸€ç™»å‡ºåè·³è½¬åˆ°ç™»å½•é¡µ login.htmlï¼Œä¿æŒä¸ Dashboard å®ˆ"
  },
  {
    "file": "src/js/features/auth_ui.js",
    "line": 149,
    "snippet": "password=')) {       const url = new URL(window.location);       url.searchParams.delete('password');       url.searc"
  },
  {
    "file": "src/js/features/auth_ui.js",
    "line": 151,
    "snippet": "password');       url.searchParams.delete('email');       url.searchParams.delete('remember');       window.history.r"
  },
  {
    "file": "src/js/features/auth_ui.js",
    "line": 158,
    "snippet": "password = form.password?.value;     const remember = form.remember?.checked === true;      if (!email || !password) "
  },
  {
    "file": "src/js/features/auth_ui.js",
    "line": 158,
    "snippet": "password?.value;     const remember = form.remember?.checked === true;      if (!email || !password) return showToast"
  },
  {
    "file": "src/js/features/auth_ui.js",
    "line": 161,
    "snippet": "password) return showToast('è¯·è¾“å…¥é‚®ç®±å’Œå¯†ç ', 'error');      try {       setBtnLoading(loginBtn, true, 'ç™»å½•ä¸­...', 'ç™»å½•');   "
  },
  {
    "file": "src/js/features/auth_ui.js",
    "line": 188,
    "snippet": "password });       if (error) throw error;       // onAuthStateChange ä¼šå¤„ç†è·³è½¬ï¼›ä¸ºç¨³å¦¥èµ·è§ï¼Œè‹¥ data.user å­˜åœ¨åˆ™ç«‹å³è§¦å‘åç»­é€»è¾‘       if (d"
  },
  {
    "file": "src/js/features/auth_ui.js",
    "line": 238,
    "snippet": "password é¡µé¢  */ function bindForgotPassword() {   const link = document.getElementById('forgotPwdLink');   const ema"
  },
  {
    "file": "src/js/features/auth_ui.js",
    "line": 251,
    "snippet": "password.html`       });       showToast('é‡ç½®é‚®ä»¶å·²å‘é€ï¼Œè¯·æ£€æŸ¥é‚®ç®±', 'success');     } catch (err) {       showToast(err?.messa"
  },
  {
    "file": "src/js/features/auth_ui.js",
    "line": 330,
    "snippet": "password = form.password?.value;     const confirm = form.confirm_password?.value;     const nickname = form.nickname?"
  },
  {
    "file": "src/js/features/auth_ui.js",
    "line": 330,
    "snippet": "password?.value;     const confirm = form.confirm_password?.value;     const nickname = form.nickname?.value;      i"
  },
  {
    "file": "src/js/features/auth_ui.js",
    "line": 334,
    "snippet": "password || !confirm) return showToast('è¯·å¡«å†™å®Œæ•´å¹¶ç¡®è®¤å¯†ç ', 'error');     if (String(password) !== String(confirm)) return sho"
  },
  {
    "file": "src/js/features/auth_ui.js",
    "line": 335,
    "snippet": "password) !== String(confirm)) return showToast('ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´', 'error');      try {       setBtnLoading(signupBtn, tru"
  },
  {
    "file": "src/js/features/auth_ui.js",
    "line": 342,
    "snippet": "password,         options: {           data: { nickname }         }       });       if (error) throw error;       "
  },
  {
    "file": "src/js/features/auth_ui.js",
    "line": 398,
    "snippet": "Tokenï¼Œç›´æ¥æœ¬åœ°æ¸…ç†ï¼Œé¿å…è§¦å‘ç½‘ç»œè¯·æ±‚å¯¼è‡´ ERR_ABORTED       try {         const { data } = await supabase.auth.getSession();         co"
  },
  {
    "file": "src/js/features/auth_ui.js",
    "line": 401,
    "snippet": "token = data?.session?.access_token;         if (!token) {           console.warn('[Auth] logout -> no session, doing "
  },
  {
    "file": "src/js/features/auth_ui.js",
    "line": 402,
    "snippet": "token) {           console.warn('[Auth] logout -> no session, doing local cleanup');           await handleLogoutSucce"
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 17,
    "snippet": "preview: null }; // ä¸­æ–‡æ³¨é‡Šï¼šæµ‹è¯•é’©å­ï¼ˆä»…å•å…ƒæµ‹è¯•ä½¿ç”¨ï¼‰ç”¨äºè¦†ç›–å†…éƒ¨æ–¹æ³•ï¼Œä¾‹å¦‚ getJWTï¼Œé¿å… ESM å¯¼å‡ºç»‘å®šå¯¼è‡´çš„ spy æ— æ³•ç”Ÿæ•ˆé—®é¢˜ let __testHooks = { getJWT: null };"
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 65,
    "snippet": "Token)  * @deprecated Phase 5 æ¨èç›´æ¥ä½¿ç”¨ SDK æ–¹æ³•  * @returns {Promise<string>} æ³¨æ„ï¼šæ”¹ä¸ºå¼‚æ­¥è¿”å›  */ export async function getJWT"
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 78,
    "snippet": "token) {     console.warn('[Supabase] setJWT is deprecated. SDK manages session automatically.'); }  /**  * åˆ¤æ–­æ˜¯å¦å·²ç™»å½•"
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 104,
    "snippet": "token = await getJWTImpl();      // ä¸­æ–‡æ³¨é‡Šï¼šç”Ÿäº§ç¯å¢ƒå¿…é¡»æä¾› JWTï¼›å¦åˆ™ç›´æ¥æŠ›é”™ï¼Œé˜»æ­¢è°ƒç”¨     if (!token && isProd) {         __lastAuthInfo"
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 107,
    "snippet": "token && isProd) {         __lastAuthInfo = { source: 'none', preview: null };         throw new Error('JWT_REQUIRED')"
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 108,
    "snippet": "preview: null };         throw new Error('JWT_REQUIRED');     }      // ä¸­æ–‡æ³¨é‡Šï¼šå¼€å‘ç¯å¢ƒå¯é€šè¿‡æ˜¾å¼å¼€å…³å…è®¸ fallbackï¼ˆå…¼å®¹æœ¬åœ°è”è°ƒï¼‰ï¼Œé»˜è®¤å…³é—­   "
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 113,
    "snippet": "token && isDev && typeof window !== 'undefined' && window.__ALLOW_DEV_AUTH_FALLBACK__) {         try {             // "
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 117,
    "snippet": "token');             if (direct) {                 parsed = JSON.parse(direct);             } else {                "
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 123,
    "snippet": "token')) {                         const raw = window.localStorage.getItem(k);                         parsed = raw ? "
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 131,
    "snippet": "token = parsed.access_token;                 source = 'localStorage';             }             // 2) è‹¥ä»æ—  Tokenï¼Œå¯ä½œä¸ºæœ€å"
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 134,
    "snippet": "Tokenï¼Œå¯ä½œä¸ºæœ€åå…œåº•ä½¿ç”¨ anon keyï¼ˆä»… Dev ä¸”æ˜¾å¼å¯ç”¨ï¼‰             const ANON = getAnonKey();             if (!token && ANON) {       "
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 136,
    "snippet": "token && ANON) {                 headers['Authorization'] = `Bearer ${ANON}`;                 const preview = ANON.sli"
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 138,
    "snippet": "preview = ANON.slice(0, 8) + 'â€¦';                 __lastAuthInfo = { source: 'anon', preview };                 logger"
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 139,
    "snippet": "preview };                 logger.warn('[AuthHdr] Dev fallback: using anon key');                 return headers;    "
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 147,
    "snippet": "token) {         headers['Authorization'] = `Bearer ${token}`;         const preview = String(token).slice(0, 8) + 'â€¦'"
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 148,
    "snippet": "token}`;         const preview = String(token).slice(0, 8) + 'â€¦';         __lastAuthInfo = { source: source === 'local"
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 149,
    "snippet": "preview = String(token).slice(0, 8) + 'â€¦';         __lastAuthInfo = { source: source === 'localStorage' ? 'localStorage"
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 149,
    "snippet": "token).slice(0, 8) + 'â€¦';         __lastAuthInfo = { source: source === 'localStorage' ? 'localStorage' : 'SDK', previe"
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 150,
    "snippet": "preview };     } else {         // Dev ä¸”æœªå¯ç”¨ fallbackï¼šä¸é™„å¸¦ Authorizationï¼Œä¾¿äºæœåŠ¡ç«¯è¿”å› 401         __lastAuthInfo = { source:"
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 153,
    "snippet": "preview: null };     }      if (isDev) {         logger.debug('[AuthHdr] source=', __lastAuthInfo.source, 'preview='"
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 157,
    "snippet": "preview=', __lastAuthInfo.preview);     }     return headers; }  /**  * è°ƒç”¨ Edge Function (å…¼å®¹æ—§ç‰ˆç­¾å)  * @param {strin"
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 157,
    "snippet": "preview);     }     return headers; }  /**  * è°ƒç”¨ Edge Function (å…¼å®¹æ—§ç‰ˆç­¾å)  * @param {string} name   * @param {Reque"
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 184,
    "snippet": "Preview: __lastAuthInfo.preview });     }          return fetch(endpoint, { ...init, headers }); }  /**  * è·å–æœ€è¿‘ä¸€æ¬¡è®¤"
  },
  {
    "file": "src/js/services/supabaseClient.js",
    "line": 184,
    "snippet": "preview });     }          return fetch(endpoint, { ...init, headers }); }  /**  * è·å–æœ€è¿‘ä¸€æ¬¡è®¤è¯ä¿¡æ¯ï¼ˆä¾› Sync å±‚åœ¨å¤±è´¥æ—¶è®°å½•ä¸Šä¸‹æ–‡ï¼‰ "
  },
  {
    "file": "src/js/sync/syncAgent.js",
    "line": 51,
    "snippet": "Preview: authCtx.preview });     if (res.status === 401 || res.status === 403) {       showToast('äº‘åŒæ­¥éœ€è¦ç™»å½•è´¦å·ï¼Œè¯·åœ¨ä¸¤ç«¯å‡ç™»å½•åé‡è¯•"
  },
  {
    "file": "src/js/sync/syncAgent.js",
    "line": 51,
    "snippet": "preview });     if (res.status === 401 || res.status === 403) {       showToast('äº‘åŒæ­¥éœ€è¦ç™»å½•è´¦å·ï¼Œè¯·åœ¨ä¸¤ç«¯å‡ç™»å½•åé‡è¯•', 'error');    "
  },
  {
    "file": "src/js/templates/digestCard.js",
    "line": 78,
    "snippet": "preview-btn btn btn-small btn-outline\" data-id=\"${escapeHTML(d.id)}\">           <span class=\"material-symbols-outlined t"
  },
  {
    "file": "src/js/templates/digestCard.js",
    "line": 79,
    "snippet": "Preview         </button>         <button class=\"digest-send-btn btn btn-small btn-primary\" data-id=\"${escapeHTML(d.id)}"
  },
  {
    "file": "src/js/views/authView.js",
    "line": 7,
    "snippet": "password) {   const { data, error } = await supabase.auth.signInWithPassword({ email, password });   if (error) throw er"
  },
  {
    "file": "src/js/views/authView.js",
    "line": 8,
    "snippet": "password });   if (error) throw error;   return data; }  export async function signUp(email, password) {   const { data,"
  },
  {
    "file": "src/js/views/authView.js",
    "line": 13,
    "snippet": "password) {   const { data, error } = await supabase.auth.signUp({ email, password, options: { emailRedirectTo: `${confi"
  },
  {
    "file": "src/js/views/authView.js",
    "line": 14,
    "snippet": "password, options: { emailRedirectTo: `${config.frontendBaseUrl}/login.html` } });   if (error) throw error;   return da"
  },
  {
    "file": "src/js/views/authView.js",
    "line": 26,
    "snippet": "password.html` });   if (error) throw error;   return data; }  // ä¸­æ–‡æ³¨é‡Šï¼šé‡å‘é‚®ç®±éªŒè¯é‚®ä»¶ï¼ˆæ³¨å†ŒéªŒè¯ï¼‰ // ä½œç”¨ï¼šå½“ç”¨æˆ·æœªéªŒè¯é‚®ç®±éœ€è¦è´­ä¹°/ç”Ÿæˆç­‰æ“ä½œæ—¶ï¼Œæä¾›å¿«é€Ÿé‡å‘å…¥å£"
  },
  {
    "file": "src/js/views/digestView.js",
    "line": 204,
    "snippet": "preview-btn', 'click', async (e, btn) => {         e.preventDefault(); e.stopPropagation();         const id = btn.getAt"
  },
  {
    "file": "src/js/views/digestView.js",
    "line": 210,
    "snippet": "Preview', placeholder: summary || 'No summary available.' });     });      // ä¸­æ–‡æ³¨é‡Šï¼šæ‰‹åŠ¨å‘é€ï¼ˆè°ƒç”¨ /enqueue-send å°†è¯¥ digest å…¥é˜Ÿï¼‰  "
  },
  {
    "file": "src/js/views/linksView.js",
    "line": 344,
    "snippet": "Private Helpers ---  function updateUIStates() {     markSubscribedButtons(); }  async function markSubscribedButtons() "
  },
  {
    "file": "supabase/config.toml",
    "line": 132,
    "snippet": "token will never expire. enable_refresh_token_rotation = true # Allows refresh tokens to be reused after expiry, up to"
  },
  {
    "file": "supabase/config.toml",
    "line": 169,
    "snippet": "secret = \"\"  [auth.email] # Allow/disallow new user signups via email to your project. enable_signup = true # If en"
  },
  {
    "file": "supabase/config.toml",
    "line": 179,
    "snippet": "password. secure_password_change = false # Controls the minimum amount of time that must pass before sending another s"
  },
  {
    "file": "supabase/config.toml",
    "line": 181,
    "snippet": "password reset email. max_frequency = \"1s\" # Number of characters used in the email OTP. otp_length = 6 # Number of "
  },
  {
    "file": "supabase/config.toml",
    "line": 229,
    "snippet": "token is issued and allows you to add additional claims based on the authentication method used. # [auth.hook.custom_ac"
  },
  {
    "file": "supabase/config.toml",
    "line": 239,
    "snippet": "token to git. Use environment variable substitution instead: auth_token = \"env(SUPABASE_AUTH_SMS_TWILIO_AUTH_TOKEN)\" \r"
  },
  {
    "file": "supabase/config.toml",
    "line": 271,
    "snippet": "secret to git. Use environment variable substitution instead: secret = \"env(SUPABASE_AUTH_EXTERNAL_APPLE_SECRET)\" # Ov"
  },
  {
    "file": "supabase/config.toml",
    "line": 272,
    "snippet": "secret = \"env(SUPABASE_AUTH_EXTERNAL_APPLE_SECRET)\" # Overrides the default auth redirectUrl. redirect_uri = \"\" # Ove"
  },
  {
    "file": "supabase/functions/confirm-recovery/index.ts",
    "line": 2,
    "snippet": "tokenï¼‰ï¼Œé€šè¿‡åé¢å‘çŸ­æœŸâ€œè®¾ç½®å¯†ç ä»¤ç‰Œâ€å¹¶é‡å®šå‘åˆ° /set-password.html // å®‰å…¨ï¼šä»¤ç‰Œä¸€æ¬¡æ€§ï¼›è¿‡æœŸæ‹’ç»ï¼›å†™å®¡è®¡ï¼›é¿å…ä¿¡æ¯æ³„éœ²ï¼ˆç»Ÿä¸€æç¤ºï¼‰  import { serve } from \"https://deno.la"
  },
  {
    "file": "supabase/functions/confirm-recovery/index.ts",
    "line": 2,
    "snippet": "password.html // å®‰å…¨ï¼šä»¤ç‰Œä¸€æ¬¡æ€§ï¼›è¿‡æœŸæ‹’ç»ï¼›å†™å®¡è®¡ï¼›é¿å…ä¿¡æ¯æ³„éœ²ï¼ˆç»Ÿä¸€æç¤ºï¼‰  import { serve } from \"https://deno.land/std@0.177.0/http/server.ts\"; i"
  },
  {
    "file": "supabase/functions/confirm-recovery/index.ts",
    "line": 30,
    "snippet": "SERVICE_ROLE_KEY')!;     const sb = createClient(supabaseUrl, serviceKey);      const u = new URL(req.url);     const to"
  },
  {
    "file": "supabase/functions/confirm-recovery/index.ts",
    "line": 34,
    "snippet": "token = String(u.searchParams.get('token') || '').trim();     const redirectBase = u.searchParams.get('redirect') || '';"
  },
  {
    "file": "supabase/functions/confirm-recovery/index.ts",
    "line": 34,
    "snippet": "token') || '').trim();     const redirectBase = u.searchParams.get('redirect') || '';     const ip = req.headers.get('x-"
  },
  {
    "file": "supabase/functions/confirm-recovery/index.ts",
    "line": 37,
    "snippet": "token) return new Response(JSON.stringify({ error: { message: 'TOKEN_REQUIRED' } }), { status: 400, headers: { ...header"
  },
  {
    "file": "supabase/functions/confirm-recovery/index.ts",
    "line": 40,
    "snippet": "token', token).eq('context', 'recovery').limit(1);     if (qErr) throw qErr;     const row = Array.isArray(rows) && rows"
  },
  {
    "file": "supabase/functions/confirm-recovery/index.ts",
    "line": 40,
    "snippet": "token).eq('context', 'recovery').limit(1);     if (qErr) throw qErr;     const row = Array.isArray(rows) && rows.length "
  },
  {
    "file": "supabase/functions/confirm-recovery/index.ts",
    "line": 52,
    "snippet": "preview: String(token).slice(0, 8) + 'â€¦' } });      // é¢å‘çŸ­æœŸâ€œè®¾ç½®å¯†ç ä»¤ç‰Œâ€ï¼ˆ15 åˆ†é’Ÿæœ‰æ•ˆï¼‰     const rnd = crypto.getRandomValues(new "
  },
  {
    "file": "supabase/functions/confirm-recovery/index.ts",
    "line": 52,
    "snippet": "token).slice(0, 8) + 'â€¦' } });      // é¢å‘çŸ­æœŸâ€œè®¾ç½®å¯†ç ä»¤ç‰Œâ€ï¼ˆ15 åˆ†é’Ÿæœ‰æ•ˆï¼‰     const rnd = crypto.getRandomValues(new Uint8Array(32));"
  },
  {
    "file": "supabase/functions/confirm-recovery/index.ts",
    "line": 58,
    "snippet": "token: setPwdToken, context: 'set_password', expires_at: expires });     if (insErr) throw insErr;      // å¦‚æœæä¾›äº† redirec"
  },
  {
    "file": "supabase/functions/confirm-recovery/index.ts",
    "line": 61,
    "snippet": "password.html?token=...     if (redirectBase) {       const location = `${redirectBase}?token=${encodeURIComponent(setPw"
  },
  {
    "file": "supabase/functions/confirm-recovery/index.ts",
    "line": 61,
    "snippet": "token=...     if (redirectBase) {       const location = `${redirectBase}?token=${encodeURIComponent(setPwdToken)}`;    "
  },
  {
    "file": "supabase/functions/confirm-recovery/index.ts",
    "line": 63,
    "snippet": "token=${encodeURIComponent(setPwdToken)}`;       return new Response('', { status: 302, headers: { ...headers, Location:"
  },
  {
    "file": "supabase/functions/confirm-recovery/index.ts",
    "line": 68,
    "snippet": "token: setPwdToken, expires_at: expires } }), { status: 200, headers: { ...headers, 'Content-Type': 'application/json' }"
  },
  {
    "file": "supabase/functions/delete-link/index.ts",
    "line": 22,
    "snippet": "SERVICE_ROLE_KEY\");     const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);     const { error } = await supabas"
  },
  {
    "file": "supabase/functions/request-recovery/index.ts",
    "line": 3,
    "snippet": "preview é“¾æ¥ï¼›ç”Ÿäº§ç¯å¢ƒæ ¹æ® EMAIL_PROVIDERï¼ˆsendgrid/mailgunï¼‰å®é™…å‘é€é‚®ä»¶ // å®‰å…¨ï¼šä¸è¦æ±‚ç”¨æˆ·ç™»å½•ï¼›ä»¤ç‰Œä¸€æ¬¡æ€§ã€1 å°æ—¶æœ‰æ•ˆï¼›å¢åŠ åŒ IP 15 åˆ†é’Ÿ â‰¥5 æ¬¡é™æµï¼›ç»Ÿä¸€å“åº”é¿å…æ³„éœ²é‚®ç®±æ˜¯å¦å­˜åœ¨  "
  },
  {
    "file": "supabase/functions/request-recovery/index.ts",
    "line": 74,
    "snippet": "SERVICE_ROLE_KEY')!;     const frontendBase = Deno.env.get('FRONTEND_BASE_URL') || '';     const sb = createClient(supab"
  },
  {
    "file": "supabase/functions/request-recovery/index.ts",
    "line": 121,
    "snippet": "preview_link: '' } : { sent: true };       return new Response(JSON.stringify({ data: payload }), { status: 200, headers"
  },
  {
    "file": "supabase/functions/request-recovery/index.ts",
    "line": 127,
    "snippet": "token = toHex(rnd.buffer);     const expires = new Date(Date.now() + 60 * 60 * 1000).toISOString();     const nonce = cr"
  },
  {
    "file": "supabase/functions/request-recovery/index.ts",
    "line": 130,
    "snippet": "token, context: 'recovery', nonce, expires_at: expires, requested_ip: ip });     if (tokErr) throw tokErr;      // ä¸­æ–‡æ³¨é‡Šï¼š"
  },
  {
    "file": "supabase/functions/request-recovery/index.ts",
    "line": 134,
    "snippet": "token=${encodeURIComponent(token)}&redirect=${encodeURIComponent(frontendBase ? `${frontendBase}/set-password.html` : ''"
  },
  {
    "file": "supabase/functions/request-recovery/index.ts",
    "line": 134,
    "snippet": "token)}&redirect=${encodeURIComponent(frontendBase ? `${frontendBase}/set-password.html` : '')}`;      // ä¸­æ–‡æ³¨é‡Šï¼šå¼€å‘ç¯å¢ƒè¿”å›é¢„è§ˆé“¾"
  },
  {
    "file": "supabase/functions/request-recovery/index.ts",
    "line": 134,
    "snippet": "password.html` : '')}`;      // ä¸­æ–‡æ³¨é‡Šï¼šå¼€å‘ç¯å¢ƒè¿”å›é¢„è§ˆé“¾æ¥ï¼›ç”Ÿäº§ç¯å¢ƒæŒ‰é…ç½®å‘é€é‚®ä»¶     if (isDev()) {       const payload = { sent: true, previ"
  },
  {
    "file": "supabase/functions/request-recovery/index.ts",
    "line": 138,
    "snippet": "preview_link: confirmUrl };       return new Response(JSON.stringify({ data: payload }), { status: 200, headers: { ...he"
  },
  {
    "file": "supabase/functions/set-password/index.ts",
    "line": 1,
    "snippet": "password Edge Function // ä½œç”¨ï¼šåœ¨éªŒè¯é€šè¿‡çš„æ¢å¤ä¼šè¯ä¸‹ä¸ºæ—¢æœ‰ç”¨æˆ·è®¾ç½®å¯†ç ï¼Œå¼€å¯ email+password ç™»å½•èƒ½åŠ› // å®‰å…¨ï¼šè¦æ±‚æœ‰æ•ˆçš„ set_password ä»¤ç‰Œï¼›å¼ºå¯†ç æ ¡éªŒï¼›å†™å®¡è®¡ï¼›ç¦æ­¢åˆ›å»ºæ–°ç”¨æˆ·  "
  },
  {
    "file": "supabase/functions/set-password/index.ts",
    "line": 2,
    "snippet": "password ç™»å½•èƒ½åŠ› // å®‰å…¨ï¼šè¦æ±‚æœ‰æ•ˆçš„ set_password ä»¤ç‰Œï¼›å¼ºå¯†ç æ ¡éªŒï¼›å†™å®¡è®¡ï¼›ç¦æ­¢åˆ›å»ºæ–°ç”¨æˆ·  import { serve } from \"https://deno.land/std@0.177.0/http/s"
  },
  {
    "file": "supabase/functions/set-password/index.ts",
    "line": 23,
    "snippet": "SERVICE_ROLE_KEY')!;     const sb = createClient(supabaseUrl, serviceKey);      const body = await req.json().catch(() ="
  },
  {
    "file": "supabase/functions/set-password/index.ts",
    "line": 27,
    "snippet": "token = String(body?.token || '').trim();     const newPwd = String(body?.new_password || '').trim();     const client_r"
  },
  {
    "file": "supabase/functions/set-password/index.ts",
    "line": 27,
    "snippet": "token || '').trim();     const newPwd = String(body?.new_password || '').trim();     const client_req_id = String(body?."
  },
  {
    "file": "supabase/functions/set-password/index.ts",
    "line": 32,
    "snippet": "token) return new Response(JSON.stringify({ error: { message: 'TOKEN_REQUIRED' } }), { status: 400, headers: { ...header"
  },
  {
    "file": "supabase/functions/set-password/index.ts",
    "line": 40,
    "snippet": "token', token).eq('context', 'set_password').limit(1);     if (qErr) throw qErr;     const row = Array.isArray(rows) && "
  },
  {
    "file": "supabase/functions/set-password/index.ts",
    "line": 40,
    "snippet": "token).eq('context', 'set_password').limit(1);     if (qErr) throw qErr;     const row = Array.isArray(rows) && rows.len"
  },
  {
    "file": "supabase/functions/set-password/index.ts",
    "line": 48,
    "snippet": "password: newPwd });     if (updUserErr) return new Response(JSON.stringify({ error: { message: updUserErr.message || 'U"
  },
  {
    "file": "supabase/functions/set-password/index.ts",
    "line": 56,
    "snippet": "preview: String(token).slice(0, 8) + 'â€¦' } });      return new Response(JSON.stringify({ data: { ok: true } }), { status"
  },
  {
    "file": "supabase/functions/set-password/index.ts",
    "line": 56,
    "snippet": "token).slice(0, 8) + 'â€¦' } });      return new Response(JSON.stringify({ data: { ok: true } }), { status: 200, headers: "
  },
  {
    "file": "supabase/functions/super-endpoint/index.ts",
    "line": 39,
    "snippet": "SERVICE_ROLE_KEY\");   const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);   // âœ… OpenAI è°ƒç”¨è´Ÿè½½ï¼ˆè¦æ±‚ä¸¥æ ¼ JSON è¾“å‡ºï¼‰   co"
  },
  {
    "file": "supabase/functions/sync-pull/index.ts",
    "line": 21,
    "snippet": "SERVICE_ROLE_KEY')!;     const supabase = createClient(supabaseUrl, serviceKey);      const jwt = req.headers.get('Au"
  },
  {
    "file": "supabase/functions/sync-push/index.ts",
    "line": 26,
    "snippet": "SERVICE_ROLE_KEY')!; // æœåŠ¡ç«¯ä»…ç”¨ Service Roleï¼›ä¸è¦åœ¨å‰ç«¯æš´éœ²     const supabase = createClient(supabaseUrl, serviceKey);      c"
  },
  {
    "file": "supabase/functions/update-link/index.ts",
    "line": 22,
    "snippet": "SERVICE_ROLE_KEY\");     const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);     const { error } = await supabas"
  },
  {
    "file": "tests/auth_fallback.test.js",
    "line": 14,
    "snippet": "token     // ä¸­æ–‡æ³¨é‡Šï¼šVitest ç¯å¢ƒä¸‹ localStorage å¯èƒ½ç”± JSDOM æä¾›ï¼Œä»å¯ç›´æ¥å†™å…¥     const fakeToken = 'FAKE_DEV_TOKEN_0123456789abcdef';  "
  },
  {
    "file": "tests/auth_fallback.test.js",
    "line": 18,
    "snippet": "token', JSON.stringify({ access_token: fakeToken }));     }     log('å†™å…¥ localStorage token ä½œä¸ºå…œåº•');      // 2) è°ƒç”¨ getAuth"
  },
  {
    "file": "tests/auth_fallback.test.js",
    "line": 20,
    "snippet": "token ä½œä¸ºå…œåº•');      // 2) è°ƒç”¨ getAuthHeadersï¼ˆå®é™…é¡¹ç›®ä¸­ä»æ¨¡å—å¯¼å…¥ï¼‰     // ç”±äºè¯¥æ–‡ä»¶ä¸ºé™æ€æµ‹è¯•æ ·ä¾‹ï¼Œå¼€å‘è€…å¯åœ¨é¡µé¢æ§åˆ¶å°æ‰§è¡Œï¼š     //   import('./src/js/servi"
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 3,
    "snippet": "password -> email/password ç™»å½•æ˜ å°„åˆ°åŒä¸€ user_id  import { describe, it, expect, vi, beforeEach } from 'vitest' import crypto "
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 3,
    "snippet": "password ç™»å½•æ˜ å°„åˆ°åŒä¸€ user_id  import { describe, it, expect, vi, beforeEach } from 'vitest' import crypto from 'node:crypto'"
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 19,
    "snippet": "preview = `${supabaseUrl}/functions/v1/confirm-recovery?token=${recoveryToken}&redirect=${encodeURIComponent('http://loc"
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 19,
    "snippet": "token=${recoveryToken}&redirect=${encodeURIComponent('http://localhost/set-password.html')}`         return { data: { se"
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 19,
    "snippet": "password.html')}`         return { data: { sent: true, preview_link: preview }, error: null, status: 200 }       }      "
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 20,
    "snippet": "preview_link: preview }, error: null, status: 200 }       }       if (name.startsWith('confirm-recovery') && method === "
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 20,
    "snippet": "preview }, error: null, status: 200 }       }       if (name.startsWith('confirm-recovery') && method === 'GET') {      "
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 25,
    "snippet": "token: setPwdToken, expires_at: new Date(Date.now() + 15 * 60 * 1000).toISOString() }, error: null, status: 200 }       "
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 27,
    "snippet": "password' && method === 'POST') {         const t = opts.body?.token         if (t !== setPwdToken) return { data: null,"
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 28,
    "snippet": "token         if (t !== setPwdToken) return { data: null, error: { message: 'TOKEN_INVALID' }, status: 400 }         ret"
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 40,
    "snippet": "password }) => ({ data: { user: { id: 'u1', email } }, error: null }))   }   return { supabase: { auth } } })  describe("
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 48,
    "snippet": "password -> login with same user_id', async () => {     const api = await import('../src/js/services/api.js')     const "
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 54,
    "snippet": "preview_link || '')).toMatch('/confirm-recovery?token=')      const preview = req.data.preview_link     const tokenInLin"
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 54,
    "snippet": "token=')      const preview = req.data.preview_link     const tokenInLink = new URL(preview).searchParams.get('token')  "
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 56,
    "snippet": "preview = req.data.preview_link     const tokenInLink = new URL(preview).searchParams.get('token')     const cnf = await"
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 56,
    "snippet": "preview_link     const tokenInLink = new URL(preview).searchParams.get('token')     const cnf = await api.invokeJSON(`co"
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 57,
    "snippet": "preview).searchParams.get('token')     const cnf = await api.invokeJSON(`confirm-recovery?token=${tokenInLink}`, { metho"
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 57,
    "snippet": "token')     const cnf = await api.invokeJSON(`confirm-recovery?token=${tokenInLink}`, { method: 'GET' })     expect(type"
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 58,
    "snippet": "token=${tokenInLink}`, { method: 'GET' })     expect(typeof cnf?.data?.token).toBe('string')      const set = await api."
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 59,
    "snippet": "token).toBe('string')      const set = await api.invokeJSON('set-password', { method: 'POST', body: { token: cnf.data.to"
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 61,
    "snippet": "password', { method: 'POST', body: { token: cnf.data.token, new_password: 'Passw0rd-XYZ' } })     expect(set?.data?.ok)."
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 61,
    "snippet": "token: cnf.data.token, new_password: 'Passw0rd-XYZ' } })     expect(set?.data?.ok).toBe(true)      const { supabase } = "
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 61,
    "snippet": "token, new_password: 'Passw0rd-XYZ' } })     expect(set?.data?.ok).toBe(true)      const { supabase } = client     const"
  },
  {
    "file": "tests/recovery_flow.integration.test.js",
    "line": 65,
    "snippet": "password: 'Passw0rd-XYZ' })     expect(res?.data?.user?.id).toBe('u1')   }) }) "
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 3,
    "snippet": "tokenã€confirm-recovery æ ‡è®° usedã€set-password æ›´æ–°å¯†ç  // å¼‚å¸¸ï¼šé‡å¤ä½¿ç”¨ï¼ˆreplayï¼‰ã€è¿‡æœŸï¼ˆexpiredï¼‰ã€ç¯¡æ”¹ï¼ˆtamperedï¼‰  import { describe, it, "
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 3,
    "snippet": "password æ›´æ–°å¯†ç  // å¼‚å¸¸ï¼šé‡å¤ä½¿ç”¨ï¼ˆreplayï¼‰ã€è¿‡æœŸï¼ˆexpiredï¼‰ã€ç¯¡æ”¹ï¼ˆtamperedï¼‰  import { describe, it, expect, beforeEach } from 'vitest'\r"
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 11,
    "snippet": "token, context, expires_at, used, used_at, ip }   audits: [], // { user_id, action, ip, details, ts }   users: new Map"
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 13,
    "snippet": "password } }  function toHex(buf) {   return Buffer.from(buf).toString('hex') }  function nowIso() { return new D"
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 24,
    "snippet": "token = toHex(crypto.randomBytes(32))   const exp = new Date(Date.now() + 60 * 60 * 1000).toISOString()   store.tokens"
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 26,
    "snippet": "token, context: 'recovery', expires_at: exp, used: false, used_at: null, ip })   store.audits.push({ user_id, action: '"
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 28,
    "snippet": "token }  // ä¸­æ–‡æ³¨é‡Šï¼šç¡®è®¤æ¢å¤ä»¤ç‰Œï¼Œé¢å‘ set_password ä»¤ç‰Œï¼ˆ15minï¼‰ function confirmRecovery(token, ip) {   const row = store.tokens."
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 32,
    "snippet": "token, ip) {   const row = store.tokens.find(t => t.token === token && t.context === 'recovery')   if (!row) return { "
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 33,
    "snippet": "token === token && t.context === 'recovery')   if (!row) return { ok: false, error: 'TOKEN_NOT_FOUND' }   if (row.used"
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 33,
    "snippet": "token && t.context === 'recovery')   if (!row) return { ok: false, error: 'TOKEN_NOT_FOUND' }   if (row.used) return {"
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 38,
    "snippet": "preview: token.slice(0,8)+'â€¦' }, ts: nowIso() })   const t2 = toHex(crypto.randomBytes(32))   const exp2 = new Date(Da"
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 38,
    "snippet": "token.slice(0,8)+'â€¦' }, ts: nowIso() })   const t2 = toHex(crypto.randomBytes(32))   const exp2 = new Date(Date.now() "
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 41,
    "snippet": "token: t2, context: 'set_password', expires_at: exp2, used: false, used_at: null, ip })   return { ok: true, token: t2 "
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 42,
    "snippet": "token: t2 } }  // ä¸­æ–‡æ³¨é‡Šï¼šè®¾ç½®å¯†ç ï¼ˆä»…åœ¨ set_password ä»¤ç‰Œä¸‹å…è®¸ï¼‰ function setPassword(token, newPwd) {   const row = store.tokens"
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 46,
    "snippet": "token, newPwd) {   const row = store.tokens.find(t => t.token === token && t.context === 'set_password')   if (!row) r"
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 47,
    "snippet": "token === token && t.context === 'set_password')   if (!row) return { ok: false, error: 'TOKEN_NOT_FOUND' }   if (row."
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 47,
    "snippet": "token && t.context === 'set_password')   if (!row) return { ok: false, error: 'TOKEN_NOT_FOUND' }   if (row.used) retu"
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 55,
    "snippet": "password: newPwd })   row.used = true; row.used_at = nowIso()   store.audits.push({ user_id: row.user_id, action: 'cre"
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 57,
    "snippet": "preview: token.slice(0,8)+'â€¦' }, ts: nowIso() })   return { ok: true } }  describe('Recovery Token Lifecycle', () =>"
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 57,
    "snippet": "token.slice(0,8)+'â€¦' }, ts: nowIso() })   return { ok: true } }  describe('Recovery Token Lifecycle', () => {   bef"
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 61,
    "snippet": "Token Lifecycle', () => {   beforeEach(() => { store.tokens = []; store.audits = []; store.users.clear(); })    it('s"
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 64,
    "snippet": "token, confirm it, and create set_password token', () => {     const uid = 'u1'; const ip = '1.2.3.4'     store.users."
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 64,
    "snippet": "token', () => {     const uid = 'u1'; const ip = '1.2.3.4'     store.users.set(uid, { email: 'u1@example.com' })     "
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 71,
    "snippet": "token).toBe('string')   })    it('confirm should mark recovery token used and reject replay', () => {     const uid "
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 74,
    "snippet": "token used and reject replay', () => {     const uid = 'u1'; const ip = '1.2.3.4'     const t = requestRecovery(uid, i"
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 84,
    "snippet": "password should update password and reject tampered/expired/replay tokens', () => {     const uid = 'u1'; const ip = '1"
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 84,
    "snippet": "password and reject tampered/expired/replay tokens', () => {     const uid = 'u1'; const ip = '1.2.3.4'     const t = "
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 87,
    "snippet": "token: sp } = confirmRecovery(t, ip)     const ok = setPassword(sp, 'Passw0rd123')     expect(ok.ok).toBe(true)     /"
  },
  {
    "file": "tests/recovery_token_lifecycle.test.js",
    "line": 101,
    "snippet": "token: t2, context: 'set_password', expires_at: past, used: false, used_at: null, ip })     const expRes = setPassword("
  },
  {
    "file": "vite.config.js",
    "line": 34,
    "snippet": "password.html'),         setpwd: path.resolve(process.cwd(), 'public/set-password.html'),         recovery: path.resolve"
  },
  {
    "file": "vite.config.js",
    "line": 35,
    "snippet": "password.html'),         recovery: path.resolve(process.cwd(), 'public/account-recovery.html'),         // ä¸­æ–‡æ³¨é‡Šï¼šå°† Servic"
  }
]